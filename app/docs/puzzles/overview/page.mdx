import { Castle, FileText, Github, MessageCircle, Twitter } from 'lucide-react';

import LinkFeature from '../../(components)/link-feature';
import PhaseTable from '@/components/common/phase-table';
import Callout from '@/components/templates/mdx/callout/index';
import Description from '@/components/templates/mdx/description';
import { getBaseMetadata } from '@/lib/utils';

export const metadata = getBaseMetadata({
  title: 'Puzzles Overview',
  description: 'Curta Puzzles is a CTF protocol, where players create and solve EVM puzzles to earn NFTs.',
  titleTemplate: '%s | Curta Docs'
});

# Puzzles Overview

<Description children="Curta Puzzles is a CTF protocol, where players create and solve EVM puzzles to earn NFTs." />

## Introduction

A puzzle becomes available for solving by anyone as soon as an author adds it to the [Curta contract](https://etherscan.io/address/0x0000000006bC8D9e5e9d436217B88De704a9F307). Upon valid submissions, a [Flag](https://opensea.io/collection/curta) NFT is minted to the solver, and they earn [points](/docs/leaderboard), which is used to place them on the [leaderboard](/leaderboard).

## Submission period

Immediately after a puzzle is added, the puzzle enters **Phase 0**, a period where nobody has solved the puzzle yet. Then, as people solve the puzzle, it progresses through 4 Phases:

<PhaseTable />

To simplify, each puzzle's submission period lasts from the time it's added until 5 days after the first valid solution is submitted (aka **First Blood**).

## Generative puzzles

<Callout>
  Every puzzle must implement a `generate(address)` function, which takes in the user's address as a seed and returns a unique starting position. This way, each puzzle is _generative_, and each solution is unique to the solver.
</Callout>

Since the protocol is 100% onchain, every submission is public. The generative aspect prevents front-running and allows for multiple winners: even if you see someone else's solution, you still have to figure out what the rules/constraints of the puzzle are and solve it from _your_ starting position.

To put it more rigorously, the [`solve` function](https://github.com/waterfall-mkt/curta/blob/2d5de33e3e08ff478ad9e33b6a6f00f819224122/src/Curta.sol#L107) on [Curta](https://etherscan.io/address/0x0000000006bC8D9e5e9d436217B88De704a9F307) requires the following to return `true`:

```sol showLineNumbers={false}
puzzle.verify(
    puzzle.generate(msg.sender), // Unique starting position, seeded by the address of the solver.
    _solution
)
```

## Learn more

<div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-1 gap-4 lg:grid-cols-3">
  {[
    {
      name: 'Submitting Solutions',
      description: 'Learn how to submit solutions.',
      href: '/docs/puzzles/submitting-solutions',
      icon: <Github />,
    },
    {
      name: 'Writing Puzzles',
      description: 'Learn how to write a puzzle.',
      href: '/docs/puzzles/writing-a-puzzle',
      icon: <Github />
    },
    {
      name: 'Becoming an Author',
      description: 'Learn how to become an author.',
      href: '/docs/puzzles/becoming-an-author',
      icon: <Github />
    },
  ].map((item) => <LinkFeature key={item.href} {...item} />)}
</div>
